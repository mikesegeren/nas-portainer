version: "3.9"

services:
  it-tools:
    image: corentinth/it-tools:latest
    container_name: it-tools
    restart: unless-stopped
    ports:
      - "8088:80"

  glance:
    image: glanceapp/glance:latest
    container_name: glance
    restart: unless-stopped
    ports:
      - "8089:8080"
    volumes:
      - ./glance:/app/config
      - /var/run/docker.sock:/var/run/docker.sock:ro

  vaultwarden:
    image: vaultwarden/server:latest
    container_name: vaultwarden
    restart: unless-stopped
    # Expose for direct LAN access; optional if you only use HTTPS via NPM
    ports:
      - "8082:80"
    volumes:
      - ${DOCKER_DATA}/vaultwarden/data:/data
    environment:
      - SIGNUPS_ALLOWED=${VAULTWARDEN_SIGNUPS_ALLOWED:-true}
      - ADMIN_TOKEN=${VAULTWARDEN_ADMIN_TOKEN}
      # Required when behind HTTPS proxy (set to your public URL, e.g. https://vault.example.com)
      - DOMAIN=${VAULTWARDEN_DOMAIN}
      - WEBSOCKET_ENABLED=true

  nginx-proxy-manager:
    image: jc21/nginx-proxy-manager:latest
    container_name: nginx-proxy-manager
    restart: unless-stopped
    ports:
      - "8080:80"   # HTTP (host 80 in use; for Let's Encrypt, forward 80→8080 on router or use DNS challenge)
      - "8443:443"  # HTTPS (host 443 in use; forward 443→8443 on router or use https://domain:8443)
      - "81:81"     # Admin UI
    volumes:
      - ${DOCKER_DATA}/nginx-proxy-manager/data:/data
      - ${DOCKER_DATA}/nginx-proxy-manager/letsencrypt:/etc/letsencrypt
